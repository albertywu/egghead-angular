// Generated by CoffeeScript 1.7.1
(function() {
  var app, appCtrl;

  app = angular.module('myApp', ['ngRoute']);

  app.config(function($routeProvider) {
    return $routeProvider.when('/', {
      templateUrl: 'homepage.html',
      controller: 'AppCtrl',
      resolve: {
        loadData: appCtrl.loadData,
        prepData: appCtrl.prepData
      }
    }).when('/map/:country/:state/:city', {
      templateUrl: 'app.html',
      controller: 'AppCtrl',
      redirectTo: function(routeParams, path, search) {
        console.log(routeParams);
        console.log(path);
        console.log(search);
        if (routeParams.country !== 'USA') {
          return "/map/USA/" + routeParams.state + "/" + routeParams.city;
        }
      }
    }).otherwise({
      redirectTo: '/'
    });
  });

  appCtrl = app.controller('AppCtrl', function($scope, $routeParams, $route) {
    return $scope.model = {
      message: "You found " + $routeParams.country + " > " + $routeParams.state + " > " + $routeParams.city
    };
  });

  appCtrl.loadData = function($q, $timeout) {
    var deferred;
    deferred = $q.defer();
    $timeout(function() {
      console.log('loading data');
      return deferred.resolve();
    }, 1000);
    return deferred.promise;
  };

  appCtrl.prepData = function($q, $timeout) {
    var deferred;
    deferred = $q.defer();
    $timeout(function() {
      console.log('prepping data');
      return deferred.resolve();
    }, 1000);
    return deferred.promise;
  };

}).call(this);
